# Cron Manager - Crontabé›†ä¸­ç®¡ç†å·¥å…·

## ğŸ“‹ ç®€ä»‹

Cron Manager æ˜¯ä¸€ä¸ªç”¨äºé›†ä¸­ç®¡ç†å¤šå°æœåŠ¡å™¨ crontab çš„å‘½ä»¤è¡Œå·¥å…·ã€‚

### æ ¸å¿ƒç‰¹æ€§
- âœ… **ç‰ˆæœ¬æ§åˆ¶**: Gitç®¡ç†é…ç½®ï¼Œæ”¯æŒå›æ»š
- âœ… **ç»Ÿä¸€ç®¡ç†**: YAMLæ ¼å¼ï¼Œå¯è¯»æ€§å¼º
- âœ… **æ‰¹é‡éƒ¨ç½²**: SSHå¹¶å‘éƒ¨ç½²åˆ°å¤šå°æœåŠ¡å™¨
- âœ… **è¯­æ³•éªŒè¯**: è‡ªåŠ¨éªŒè¯cronè¡¨è¾¾å¼å’Œå‘½ä»¤
- âœ… **é…ç½®å¯¹æ¯”**: å¯¹æ¯”ä¸åŒç¯å¢ƒå·®å¼‚
- âœ… **è‡ªåŠ¨å¤‡ä»½**: éƒ¨ç½²å‰è‡ªåŠ¨å¤‡ä»½ç°æœ‰crontab
- âœ… **å¤šç¯å¢ƒ**: æ”¯æŒ dev/test/prod ç­‰å¤šç¯å¢ƒ

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–
```bash
pip install pyyaml paramiko colorama --break-system-packages
```

### 2. ç›®å½•ç»“æ„
```
cron-manager/
â”œâ”€â”€ cron_manager.py      # ä¸»ç¨‹åº
â”œâ”€â”€ config/              # é…ç½®ç›®å½•
â”‚   â”œâ”€â”€ prod.yaml        # ç”Ÿäº§ç¯å¢ƒ
â”‚   â”œâ”€â”€ test.yaml        # æµ‹è¯•ç¯å¢ƒ
â”‚   â””â”€â”€ dev.yaml         # å¼€å‘ç¯å¢ƒ
â””â”€â”€ README.md
```

### 3. é…ç½®æ–‡ä»¶ç¤ºä¾‹
```yaml
# config/prod.yaml
environment:
  PATH: /usr/local/bin:/usr/bin:/bin
  SHELL: /bin/bash
  MAILTO: ops@company.com

servers:
  - group: web
    hosts:
      - web-01.prod.example.com
      - web-02.prod.example.com

jobs:
  - name: backup-database
    description: æ¯å¤©å‡Œæ™¨2ç‚¹å¤‡ä»½æ•°æ®åº“
    schedule: "0 2 * * *"
    command: "/opt/scripts/backup_database.sh"
    user: root
    enabled: true
    log_stdout: /var/log/cron/backup-db.log
    log_stderr: /var/log/cron/backup-db.error.log
  
  - name: cleanup-temp
    schedule: "*/30 * * * *"
    command: "find /tmp -mtime +7 -delete"
    user: root
    enabled: true
```

### 4. åŸºç¡€ä½¿ç”¨
```bash
# åˆ—å‡ºæ‰€æœ‰ä»»åŠ¡
python cron_manager.py list prod

# éªŒè¯é…ç½®
python cron_manager.py validate prod

# é¢„è§ˆcrontabå†…å®¹
python cron_manager.py show prod

# å¯¹æ¯”ä¸¤ä¸ªç¯å¢ƒ
python cron_manager.py diff prod test

# æ¼”ä¹ éƒ¨ç½²ï¼ˆä¸å®é™…æ‰§è¡Œï¼‰
python cron_manager.py deploy prod --dry-run

# å®é™…éƒ¨ç½²
python cron_manager.py deploy prod --ssh-key ~/.ssh/id_rsa
```

---

## ğŸ“– è¯¦ç»†ä½¿ç”¨

### å‘½ä»¤è¯¦è§£

#### list - åˆ—å‡ºä»»åŠ¡
```bash
# åˆ—å‡ºæŒ‡å®šç¯å¢ƒçš„æ‰€æœ‰ä»»åŠ¡
python cron_manager.py list prod

# è¾“å‡ºç¤ºä¾‹ï¼š
# ================================================================================
# ç¯å¢ƒ: prod
# é…ç½®æ–‡ä»¶: config/prod.yaml
# ================================================================================
# 
# åç§°                 è°ƒåº¦            ç”¨æˆ·       çŠ¶æ€     å‘½ä»¤
# -------------------- --------------- ---------- -------- ----------------------------------------
# backup-database      0 2 * * *       root       å¯ç”¨     /opt/scripts/backup_database.sh
# cleanup-temp         */30 * * * *    root       å¯ç”¨     find /tmp -mtime +7 -delete
# ...
```

#### validate - éªŒè¯é…ç½®
```bash
# éªŒè¯é…ç½®æ–‡ä»¶è¯­æ³•å’Œcronè¡¨è¾¾å¼
python cron_manager.py validate prod

# éªŒè¯é¡¹ç›®ï¼š
# - YAMLè¯­æ³•
# - å¿…éœ€å­—æ®µ
# - Cronè¡¨è¾¾å¼æ ¼å¼
# - å‘½ä»¤å®‰å…¨æ€§
# - ä»»åŠ¡åç§°é‡å¤
```

#### show - é¢„è§ˆcrontab
```bash
# æ˜¾ç¤ºå°†è¦ç”Ÿæˆçš„crontabå†…å®¹
python cron_manager.py show prod

# è¾“å‡ºç¤ºä¾‹ï¼š
# ================================================================================
# Crontab å†…å®¹é¢„è§ˆ: prod
# ================================================================================
# 
# # Generated by Cron Manager
# # Generated at: 2024-02-12 10:30:00
# # Config file: config/prod.yaml
# 
# PATH=/usr/local/bin:/usr/bin:/bin
# SHELL=/bin/bash
# MAILTO=ops@company.com
# 
# # backup-database
# # æ¯å¤©å‡Œæ™¨2ç‚¹å¤‡ä»½æ•°æ®åº“
# 0 2 * * * /opt/scripts/backup_database.sh >> /var/log/cron/backup-db.log 2>&1
```

#### diff - å¯¹æ¯”ç¯å¢ƒ
```bash
# å¯¹æ¯”ä¸¤ä¸ªç¯å¢ƒçš„é…ç½®å·®å¼‚
python cron_manager.py diff prod test

# ä½¿ç”¨å½©è‰²diffæ˜¾ç¤ºå·®å¼‚
# ç»¿è‰² = æ–°å¢
# çº¢è‰² = åˆ é™¤
# æ— è‰² = ç›¸åŒ
```

#### deploy - éƒ¨ç½²é…ç½®
```bash
# åŸºç¡€éƒ¨ç½²
python cron_manager.py deploy prod --ssh-key ~/.ssh/id_rsa

# æ¼”ä¹ æ¨¡å¼ï¼ˆåªæ˜¾ç¤ºå°†è¦åšä»€ä¹ˆï¼Œä¸å®é™…æ‰§è¡Œï¼‰
python cron_manager.py deploy prod --dry-run

# æŒ‡å®šç›®æ ‡ä¸»æœº
python cron_manager.py deploy prod \
  --hosts web-01.prod.example.com,web-02.prod.example.com \
  --ssh-key ~/.ssh/id_rsa

# ä½¿ç”¨å¯†ç è®¤è¯
python cron_manager.py deploy prod --ssh-user root
# ï¼ˆä¼šæç¤ºè¾“å…¥å¯†ç ï¼‰

# è‡ªå®šä¹‰å¹¶å‘æ•°
python cron_manager.py deploy prod \
  --ssh-key ~/.ssh/id_rsa \
  --workers 20
```

---

## ğŸ“ é…ç½®æ–‡ä»¶è¯¦è§£

### å®Œæ•´é…ç½®ç¤ºä¾‹
```yaml
# ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰
environment:
  PATH: /usr/local/bin:/usr/bin:/bin:/usr/local/sbin:/usr/sbin
  SHELL: /bin/bash
  MAILTO: ops@company.com
  LANG: en_US.UTF-8

# æœåŠ¡å™¨åˆ†ç»„
servers:
  - group: web
    hosts:
      - web-01.prod.example.com
      - web-02.prod.example.com
      - web-03.prod.example.com
  
  - group: database
    hosts:
      - db-01.prod.example.com
      - db-02.prod.example.com

# å®šæ—¶ä»»åŠ¡
jobs:
  - name: backup-database          # ä»»åŠ¡åç§°ï¼ˆå¿…éœ€ï¼Œå”¯ä¸€ï¼‰
    description: å¤‡ä»½æ•°æ®åº“        # æè¿°ï¼ˆå¯é€‰ï¼‰
    schedule: "0 2 * * *"          # Cronè¡¨è¾¾å¼ï¼ˆå¿…éœ€ï¼‰
    command: "/path/to/script.sh"  # å‘½ä»¤ï¼ˆå¿…éœ€ï¼‰
    user: root                     # æ‰§è¡Œç”¨æˆ·ï¼ˆå¯é€‰ï¼Œé»˜è®¤rootï¼‰
    enabled: true                  # æ˜¯å¦å¯ç”¨ï¼ˆå¯é€‰ï¼Œé»˜è®¤trueï¼‰
    log_stdout: /var/log/job.log   # æ ‡å‡†è¾“å‡ºæ—¥å¿—ï¼ˆå¯é€‰ï¼‰
    log_stderr: /var/log/job.err   # é”™è¯¯è¾“å‡ºæ—¥å¿—ï¼ˆå¯é€‰ï¼‰
```

### Cronè¡¨è¾¾å¼æ ¼å¼
```
# æ ¼å¼ï¼šåˆ† æ—¶ æ—¥ æœˆ å‘¨
# * * * * *
# â”‚ â”‚ â”‚ â”‚ â”‚
# â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€ æ˜ŸæœŸ (0-7, 0å’Œ7éƒ½æ˜¯å‘¨æ—¥)
# â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€ æœˆä»½ (1-12)
# â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€ æ—¥æœŸ (1-31)
# â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€ å°æ—¶ (0-23)
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ åˆ†é’Ÿ (0-59)

# ç¤ºä¾‹ï¼š
0 2 * * *        # æ¯å¤©å‡Œæ™¨2ç‚¹
*/30 * * * *     # æ¯30åˆ†é’Ÿ
0 9-18 * * 1-5   # å·¥ä½œæ—¥9ç‚¹åˆ°18ç‚¹
0 0 1 * *        # æ¯æœˆ1å·å‡Œæ™¨
0 0 * * 0        # æ¯å‘¨æ—¥å‡Œæ™¨
```

### ç‰¹æ®Šç”¨æ³•
```yaml
# 1. æœˆæœ«ä»»åŠ¡
- name: end-of-month
  schedule: "0 23 28-31 * *"
  command: "[ $(date -d tomorrow +\\%d) -eq 1 ] && /opt/scripts/monthly.sh"

# 2. å·¥ä½œæ—¥ä»»åŠ¡
- name: weekday-task
  schedule: "0 9 * * 1-5"
  command: "/opt/scripts/weekday.sh"

# 3. å¤šä¸ªæ—¶é—´ç‚¹
- name: multiple-times
  schedule: "0 8,12,18 * * *"
  command: "/opt/scripts/task.sh"

# 4. æ—¥å¿—åˆ†ç¦»
- name: with-logs
  schedule: "0 * * * *"
  command: "/opt/scripts/task.sh"
  log_stdout: /var/log/task.log
  log_stderr: /var/log/task.error.log

# 5. ç¦ç”¨çš„ä»»åŠ¡ï¼ˆä¿ç•™é…ç½®ä½†ä¸éƒ¨ç½²ï¼‰
- name: disabled-task
  schedule: "0 2 * * *"
  command: "/opt/scripts/old.sh"
  enabled: false
```

---

## ğŸ”§ é«˜çº§åŠŸèƒ½

### 1. Gitç‰ˆæœ¬æ§åˆ¶
```bash
# åˆå§‹åŒ–Gitä»“åº“
cd cron-manager
git init
git add config/
git commit -m "Initial cron configurations"

# åˆ›å»ºåˆ†æ”¯ç®¡ç†ä¸åŒç¯å¢ƒ
git checkout -b production
git checkout -b testing

# æŸ¥çœ‹å†å²å˜æ›´
git log --oneline config/prod.yaml

# å›æ»šåˆ°ä¹‹å‰ç‰ˆæœ¬
git checkout HEAD~1 config/prod.yaml
python cron_manager.py deploy prod --ssh-key ~/.ssh/id_rsa
```

### 2. å¤šç¯å¢ƒç®¡ç†
```bash
# ç›®å½•ç»“æ„
config/
â”œâ”€â”€ prod.yaml       # ç”Ÿäº§ç¯å¢ƒ
â”œâ”€â”€ test.yaml       # æµ‹è¯•ç¯å¢ƒ
â”œâ”€â”€ dev.yaml        # å¼€å‘ç¯å¢ƒ
â”œâ”€â”€ staging.yaml    # é¢„å‘å¸ƒç¯å¢ƒ
â””â”€â”€ dr.yaml         # ç¾å¤‡ç¯å¢ƒ

# ä½¿ç”¨
python cron_manager.py list prod
python cron_manager.py list test
python cron_manager.py diff prod test
```

### 3. ç°åº¦å‘å¸ƒ
```bash
# ç¬¬ä¸€æ­¥ï¼šéƒ¨ç½²åˆ°éƒ¨åˆ†æœåŠ¡å™¨
python cron_manager.py deploy prod \
  --hosts web-01.prod.example.com \
  --ssh-key ~/.ssh/id_rsa

# è§‚å¯Ÿä¸€æ®µæ—¶é—´ï¼Œç¡®è®¤æ— é—®é¢˜

# ç¬¬äºŒæ­¥ï¼šå…¨é‡éƒ¨ç½²
python cron_manager.py deploy prod --ssh-key ~/.ssh/id_rsa
```

### 4. ç´§æ€¥å›æ»š
```bash
# æ–¹æ³•1ï¼šä½¿ç”¨Gitå›æ»šé…ç½®
git log config/prod.yaml
git checkout <commit-hash> config/prod.yaml
python cron_manager.py deploy prod --ssh-key ~/.ssh/id_rsa

# æ–¹æ³•2ï¼šä½¿ç”¨æœåŠ¡å™¨å¤‡ä»½
# å¤‡ä»½ä½ç½®ï¼š/var/backups/crontab/crontab.<user>.<timestamp>
ssh web-01 "crontab -u root /var/backups/crontab/crontab.root.20240212_100000"
```

### 5. è‡ªåŠ¨åŒ–CI/CDé›†æˆ
```yaml
# .gitlab-ci.yml
deploy-cron:
  stage: deploy
  only:
    - master
  script:
    - pip install pyyaml paramiko colorama
    - python cron_manager.py validate prod
    - python cron_manager.py deploy prod --ssh-key $SSH_PRIVATE_KEY
  when: manual  # æ‰‹åŠ¨è§¦å‘
```

---

## ğŸ›¡ï¸ å®‰å…¨å»ºè®®

### 1. SSHå¯†é’¥ç®¡ç†
```bash
# ç”Ÿæˆä¸“ç”¨å¯†é’¥
ssh-keygen -t rsa -b 4096 -C "cron-manager" -f ~/.ssh/cron_manager_key

# åˆ†å‘åˆ°æ‰€æœ‰æœåŠ¡å™¨
ssh-copy-id -i ~/.ssh/cron_manager_key.pub root@server

# ä½¿ç”¨
python cron_manager.py deploy prod --ssh-key ~/.ssh/cron_manager_key
```

### 2. é…ç½®æ–‡ä»¶æƒé™
```bash
# é™åˆ¶é…ç½®ç›®å½•æƒé™
chmod 700 config/
chmod 600 config/*.yaml

# Gitå¿½ç•¥æ•æ„Ÿä¿¡æ¯
echo "config/prod.yaml" >> .gitignore  # ç”Ÿäº§é…ç½®ä¸å…¥åº“
```

### 3. å±é™©å‘½ä»¤æ£€æµ‹
å·¥å…·ä¼šè‡ªåŠ¨æ£€æµ‹ä»¥ä¸‹å±é™©å‘½ä»¤ï¼š
- `rm -rf /`
- `dd if=... of=/dev/...`
- `mkfs.*`
- `format`

### 4. å®¡è®¡æ—¥å¿—
```bash
# å»ºè®®è®°å½•æ‰€æœ‰éƒ¨ç½²æ“ä½œ
python cron_manager.py deploy prod --ssh-key ~/.ssh/id_rsa 2>&1 | \
  tee -a /var/log/cron-manager-deploy.log

# è®°å½•æ ¼å¼
# [2024-02-12 10:30:00] User: admin, Env: prod, Action: deploy, Result: success
```

---

## ğŸ“Š æœ€ä½³å®è·µ

### 1. é…ç½®æ–‡ä»¶ç»„ç»‡
```yaml
# æŒ‰åŠŸèƒ½åˆ†ç»„ä»»åŠ¡
jobs:
  # ===== å¤‡ä»½ä»»åŠ¡ =====
  - name: backup-database
    ...
  
  - name: backup-logs
    ...
  
  # ===== æ¸…ç†ä»»åŠ¡ =====
  - name: cleanup-temp
    ...
  
  # ===== ç›‘æ§ä»»åŠ¡ =====
  - name: check-disk
    ...
```

### 2. ä»»åŠ¡å‘½åè§„èŒƒ
```yaml
# å¥½çš„å‘½å
- name: backup-mysql-daily
- name: cleanup-logs-weekly
- name: sync-user-data-hourly

# ä¸å¥½çš„å‘½å
- name: task1
- name: backup
- name: cron_job
```

### 3. æ—¥å¿—ç®¡ç†
```yaml
# ä¸ºé‡è¦ä»»åŠ¡é…ç½®æ—¥å¿—
- name: critical-backup
  schedule: "0 2 * * *"
  command: "/opt/scripts/backup.sh"
  log_stdout: /var/log/cron/backup.log
  log_stderr: /var/log/cron/backup.error.log

# æ—¥å¿—è½®è½¬é…ç½® /etc/logrotate.d/cron-jobs
/var/log/cron/*.log {
    daily
    rotate 30
    compress
    delaycompress
    missingok
    notifempty
}
```

### 4. éƒ¨ç½²æµç¨‹
```bash
# æ ‡å‡†éƒ¨ç½²æµç¨‹
1. ä¿®æ”¹é…ç½®æ–‡ä»¶
2. éªŒè¯é…ç½®: python cron_manager.py validate prod
3. æŸ¥çœ‹å·®å¼‚: python cron_manager.py diff prod test
4. é¢„è§ˆå†…å®¹: python cron_manager.py show prod
5. æ¼”ä¹ éƒ¨ç½²: python cron_manager.py deploy prod --dry-run
6. æäº¤Git: git commit -am "Update cron jobs"
7. å®é™…éƒ¨ç½²: python cron_manager.py deploy prod --ssh-key ~/.ssh/id_rsa
8. éªŒè¯ç»“æœ: ssh server "crontab -l"
```

---

## ğŸ” æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

#### 1. SSHè¿æ¥å¤±è´¥
```bash
# é”™è¯¯ï¼šSSHè¿æ¥è¶…æ—¶
# æ’æŸ¥ï¼š
ping target-host
telnet target-host 22
ssh -v root@target-host

# è§£å†³ï¼š
# - æ£€æŸ¥ç½‘ç»œè¿é€šæ€§
# - ç¡®è®¤SSHæœåŠ¡è¿è¡Œ
# - éªŒè¯é˜²ç«å¢™è§„åˆ™
# - æ£€æŸ¥SSHå¯†é’¥æƒé™
```

#### 2. é…ç½®éªŒè¯å¤±è´¥
```bash
# é”™è¯¯ï¼šCronè¡¨è¾¾å¼é”™è¯¯
# æ’æŸ¥ï¼š
python cron_manager.py validate prod

# å¸¸è§é”™è¯¯ï¼š
# - å­—æ®µæ•°é‡ä¸å¯¹ï¼ˆå¿…é¡»5ä¸ªï¼‰
# - å€¼è¶…å‡ºèŒƒå›´
# - æ ¼å¼é”™è¯¯

# åœ¨çº¿éªŒè¯å·¥å…·ï¼š
# https://crontab.guru/
```

#### 3. éƒ¨ç½²å¤±è´¥
```bash
# é”™è¯¯ï¼šæƒé™ä¸è¶³
# è§£å†³ï¼š
# - ç¡®è®¤SSHç”¨æˆ·æœ‰sudoæƒé™
# - æˆ–ä½¿ç”¨rootç”¨æˆ·

# é”™è¯¯ï¼šcrontabå‘½ä»¤ä¸å­˜åœ¨
# è§£å†³ï¼š
ssh server "which crontab"
ssh server "yum install cronie -y"  # CentOS
ssh server "apt-get install cron -y"  # Ubuntu
```

#### 4. ä»»åŠ¡æœªæ‰§è¡Œ
```bash
# æ£€æŸ¥cronæœåŠ¡
ssh server "systemctl status cron"
ssh server "systemctl status crond"

# æŸ¥çœ‹cronæ—¥å¿—
ssh server "tail -f /var/log/cron"
ssh server "grep CRON /var/log/syslog"

# éªŒè¯crontab
ssh server "crontab -l"

# æ‰‹åŠ¨æµ‹è¯•å‘½ä»¤
ssh server "bash -c 'command from crontab'"
```

---

## ğŸ“ˆ ç›‘æ§ä¸å‘Šè­¦

### ä»»åŠ¡æ‰§è¡Œç›‘æ§

#### æ–¹æ³•1ï¼šWrapperè„šæœ¬
```bash
#!/bin/bash
# /usr/local/bin/cron-wrapper
# ç”¨æ³•: cron-wrapper <job_name> <command>

JOB_NAME="$1"
shift
COMMAND="$@"

START_TIME=$(date +%s)
$COMMAND
EXIT_CODE=$?
END_TIME=$(date +%s)
DURATION=$((END_TIME - START_TIME))

# è®°å½•æ—¥å¿—
echo "$(date +'%Y-%m-%d %H:%M:%S') | $JOB_NAME | $EXIT_CODE | ${DURATION}s" >> /var/log/cron-execution.log

# å¤±è´¥å‘Šè­¦
if [ $EXIT_CODE -ne 0 ]; then
    echo "Cron job failed: $JOB_NAME" | mail -s "Cron Alert" ops@company.com
fi

exit $EXIT_CODE
```

#### æ–¹æ³•2ï¼šç›‘æ§è„šæœ¬
```bash
#!/bin/bash
# check-cron-execution.sh

LOG_FILE="/var/log/cron-execution.log"
ALERT_THRESHOLD=5  # 5åˆ†é’Ÿå†…å¤±è´¥æ¬¡æ•°

# æ£€æŸ¥æœ€è¿‘5åˆ†é’Ÿçš„å¤±è´¥
FAILED_COUNT=$(grep "$(date -d '5 minutes ago' +'%Y-%m-%d %H:%M')" $LOG_FILE | \
               awk '$5 != "0"' | wc -l)

if [ $FAILED_COUNT -ge $ALERT_THRESHOLD ]; then
    echo "Warning: $FAILED_COUNT cron jobs failed in last 5 minutes" | \
         mail -s "Cron Alert" ops@company.com
fi
```

---

## ğŸš€ æ‰©å±•å¼€å‘

### æ·»åŠ æ–°åŠŸèƒ½

#### 1. æ·»åŠ rollbackå‘½ä»¤
```python
# åœ¨ CronManager ç±»ä¸­æ·»åŠ 
def rollback(self, env: str, version: str):
    """å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬"""
    # git checkout <version> config/{env}.yaml
    # ç„¶åéƒ¨ç½²
    pass
```

#### 2. æ·»åŠ Webç•Œé¢
```python
from flask import Flask, render_template, request
app = Flask(__name__)

@app.route('/')
def index():
    manager = CronManager()
    envs = manager.list_configs()
    return render_template('index.html', envs=envs)

@app.route('/jobs/<env>')
def show_jobs(env):
    manager = CronManager()
    config = manager.load_config(env)
    jobs = config.get_jobs()
    return render_template('jobs.html', env=env, jobs=jobs)
```

#### 3. æ·»åŠ æ‰§è¡Œæ—¥å¿—æ”¶é›†
```python
def collect_logs(self, host: str) -> dict:
    """æ”¶é›†ä»»åŠ¡æ‰§è¡Œæ—¥å¿—"""
    client = self._get_ssh_client(host)
    
    # è§£æ /var/log/cron
    cmd = "grep CRON /var/log/cron | tail -100"
    stdin, stdout, stderr = client.exec_command(cmd)
    logs = stdout.read().decode()
    
    # è§£ææ—¥å¿—ï¼Œè¿”å›ç»“æ„åŒ–æ•°æ®
    return parse_cron_logs(logs)
```

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [Crontabè¡¨è¾¾å¼åœ¨çº¿å·¥å…·](https://crontab.guru/)
- [Cronè¯­æ³•è¯¦è§£](https://www.man7.org/linux/man-pages/man5/crontab.5.html)
- [Paramikoæ–‡æ¡£](https://docs.paramiko.org/)
- [YAMLè¯­æ³•](https://yaml.org/)

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

## ğŸ“„ License

MIT License

---

**ç‰ˆæœ¬**: v1.0.0  
**æ›´æ–°æ—¶é—´**: 2024-02-12  
**ä½œè€…**: DevOps Team
